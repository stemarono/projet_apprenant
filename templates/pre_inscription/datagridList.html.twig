{% extends 'base.html.twig' %}

{% block title %}Liste des pré-inscriptions{% endblock %}
{% block body %}
<div>
    <h1>Liste des pré-inscriptions</h1>
    <div class='d-flex my-4 justify-content-between'>
        <a class="btn btn-md btn-success" href="javascript:ajouterPreInscription()">Ajouter</a>
        <a class="btn btn-md btn-primary" href="javascript:modifierPreInscription()">Modifier</a>
        <a class="btn btn-md btn-danger" href="javascript:supprimerPreInscription()">Supprimer</a>
        <a class="btn btn-md btn-primary" href="javascript:afficherPreInscription()">Afficher</a>
    </div>
    <table id="table" class="w-100"></table>
</div>
<script>
var inscrip=$('#table');
var url_datagrid_data="{{path('app_preInscription_datagrid_data')}}";
var url_preInscription_edit="{{path('app_pre_inscription_edit',{'id':'preInscription_id'})}}";
var url_preInscription_show="{{path('app_pre_inscription_show',{'id':'preInscription_id'})}}";
var url_preInscription_new="{{path('app_pre_inscription_new')}}";
var url_preInscription_delete="{{path('app_pre_inscription_delete',{'id':'preInscription_id'})}}";

$(function(){
    
     loadListPreInscription();
});


    function loadListPreInscription()
    {
        $("#table").datagrid({
            url:url_datagrid_data,
            idField:'id',
            singleSelect:true,
            pageSize:20,
            pageList:[20,30,50,100,300],
            pagination:true,
            fit:true,
            fitColumns:true,
            columns:[[
                    {'field':'id','title':'ID','width':'10%','halign':'center','align':'center'},
                    {'field':'nom','title':'Nom','width':'20%','halign':'center','align':'center'},
                    {'field':'prenom','title':'Prénom','width':'20%','halign':'center','align':'left'},
                    {'field':'dateNaissance','title':'date de naissance','width':'10%','halign':'center','align':'right'},
                    {'field':'sexe','title':'Sexe','width':'10%','halign':'center','align':'right'},
                    {'field':'adresse','title':'Adresse','width':'10%','halign':'center','align':'right'},
                    {'field':'codePostal','title':'Code postal','width':'10%','halign':'center','align':'right'},
                    {'field':'ville','title':'Ville','width':'10%','halign':'center','align':'right'},
                    {'field':'region','title':'Région','width':'10%','halign':'center','align':'right'},
                    {'field':'pays','title':'Pays','width':'10%','halign':'center','align':'right'},
                    {'field':'email','title':'Email','width':'10%','halign':'center','align':'right'},
                    {'field':'carteIdentite','title':'Carte Identité','width':'10%','halign':'center','align':'right'},
                    {'field':'justifFinancement','title':'justificatif financement','width':'10%','halign':'center','align':'right'},
                    {'field':'autreDoc','title':'autre document','width':'10%','halign':'center','align':'right'},
                    {'field':'n_ss','title':'numéro de SS','width':'10%','halign':'center','align':'right'},
                    {'field':'telephone','title':'Téléphone','width':'10%','halign':'center','align':'right'},
                    {'field':'user','title':'User','width':'10%','halign':'center','align':'right'},    
            ]],
            onDblClickRow:function(val,row)
            {
                var id=row.id;
                afficherPreInscription();
            }
           
        });
        $("#table").datagrid('enableFilter');
    }
  
    function afficherPreInscription(){
    var row=inscrip.datagrid('getSelected');
    if(row){
        var id=row['id'];
        var url=url_article_show.replace('preInscription_id',id);
        popupCenter(url,'show'+id,screen.width*0.70, screen.height*0.60);
    }else{
        alert('Sélectionnez bien une ligne');
    }
}
function ajouterPreInscription(){
    popupCenter(url_article_new,'new',screen.width*0.70,screen.height*0.60);
}

function modifierPreInscription(){
    var row= inscrip.datagrid('getselected');
    if(row)
    {
        var id= row['id'];
        var url=url_preInscription_edit.replace('preInscription_id',id);
        popupCenter(url,'edit'+id,screen.width*0.70,screen.height*0.60);
    }else{
        alert('Sélectionnez bien une ligne !');
    }
}
function supprimerPreInscription()
{
    var row=inscrip.datagrid('getSelected');
    if(row)
    {
        var id=row['id'];
        if(confirm("Voulez-vous vraiement supprimer cette pré-inscription"+row.prenom+" ?"))
        {
            var url=url_article_delete.replace('preInscription_id',id);
            document.location.href=url;
        }else{
            alert('Selectionnez bien une ligne ');
        }
    }

}

</script>
{% endblock %}